apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "kgw.fullname" . }}
  labels:
    {{- include "kgw.labels" . | nindent 4 }}
data:
  {{- $grpcHost := include "kwild.fullname" .Subcharts.kwild }}
  {{ $graphqlHost := printf "%s-hasura" .Release.Name -}}
  GRAPHQL_ENDPOINT: {{ printf "http://%s:%d" $graphqlHost (int .Values.hasura.service.ports.hasura) | quote }}
  GRPC_ENDPOINT: {{ printf "%s:%d" $grpcHost (int .Values.kwild.service.ports.kwild) | quote }}
  GATEWAY_CORS: {{ .Values.kgw.cors | quote | default "" }}
  HEALTHCHECK_KEY: {{ .Values.kgw.healthcheckKey | sha256sum }}