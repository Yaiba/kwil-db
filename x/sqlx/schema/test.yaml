owner: kwil
name: mydb
default_role: bennanmode
tables:
  tblUser:
    columns:
      user_id:
        type: int32
        attributes:
          primary_key: true
      first_name:
        type: string
      last_name:
        type: string
      age:
        type: int32
      user_type:
        type: string
  table2:
    columns:
      t2col1:
        type: int32
        attributes:
          primary_key: true
      t2col2:
        type: int64
roles:
  bennanmode:
    queries:
      - createUser
      - updateUser
      - removeUser
  randalmode:
    queries:
      - createUser
      - updateUser
      - removeUser
      - createAdminUser
      - updateAdminUser
      - removeAdminUser
queries:
  createUser:
    type: create
    table: tblUser
    columns: {user_id, first_name, last_name, age, user_type: standard}

  updateUser:
    type: update
    table: tblUser
    columns: {first_name, last_name, age}
    where: 
      - {
        column: user_type,
        operator: "=",
        default: standard
      }
      - {
        column: age,
        operator: ">"
      }

  removeUser: # using both quotes and no quotes works
    type: "delete"
    table: tblUser
    if-match: {user_id, user_type: standard}
    where: 
    - {
      column: user_type,
      operator: "=",
      default: standard
    }

  createAdminUser:
    type: create
    table: tblUser
    columns: {user_id, first_name, last_name, age, user_type: admin}

  updateAdminUser:
    type: update
    table: tblUser
    columns: {first_name, last_name, age}
    if-match: {user_id, user_type: admin}

  removeAdminUser:
    type: delete
    table: tblUser
    if-match: {user_id, user_type: admin}
indexes:
  user_age:
    table: tblUser
    column: age
    using: btree